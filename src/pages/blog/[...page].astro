---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import BaseLayout from "@layouts/BaseLayout.astro";
import Pagination from "@components/Pagination.astro";
import BlogCard from "@components/BlogCard.astro";
import BlogCardList from "@components/BlogCardList.astro";

const title = "Blog";
const description = "A list of all blog posts";

export const getStaticPaths = (async ({ paginate }) => {
  const entries = await getCollection(
    "posts",
    (post) => post.data.draft !== true
  );
  const posts = entries.sort(
    (a, b) => b.data.createdAt.valueOf() - a.data.createdAt.valueOf()
  );

  return paginate(posts, { pageSize: 10 });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<BaseLayout {title} {description}>
  <main>
    <div
      class="absolute inset-0 -top-40 -z-50 bg-[image:radial-gradient(ellipse_at_50%_0%,_rgba(32_8_140_/_0.75)_1%,_#09090b_76%),_url('/gcmmhero-scaled.jpg')] bg-cover bg-center bg-no-repeat">
    </div>
    <div class="px-6 py-40">
      <h1 class="text-5xl font-black uppercase text-white">{title}</h1>
    </div>
    <BlogCardList posts={page.data} />
    <Pagination
      prevUrl={page.url.prev}
      nextUrl={page.url.next}
      currentUrl={page.url.current}
      currentPage={page.currentPage}
      lastPage={page.lastPage}
    />

    <!-- <div>
      <div
        class="rounded-md bg-indigo-500 bg-[image:linear-gradient(rgba(88_101_242_/_0.7),_rgba(88_101_242_/_0.7)),_url('/Discord-Logo-White.svg')] bg-[auto,_30%_auto] bg-[10%_50%] bg-no-repeat">
        <div class="flex flex-col items-center gap-2 p-4">
          <div class="text-sm uppercase text-zinc-100">
            Come join our Discord community!
          </div>
          <div>
            <a
              class="bg-red-600 px-3 py-1 text-sm uppercase text-white"
              href="http://discord.ghostcap.com/">Click to join</a
            >
          </div>
        </div>
      </div>
    </div> -->
  </main>
</BaseLayout>
